Screen_AddNewCustomerTargetPricing As screen:
    BackgroundImage: =
    OnVisible: |-
        =ClearCollect(Products,{'Product Description':"",'Product Code':"",'Alc %':"",'Carton Quantity':"",Varient:"",'De-Coded':"",'Non-Refill':"",'Customer Min Price':"",'Customer Max Price':"",'Customer Currency':"",'Qty Required':"",'Lt/Btl':""});
        Clear(Products);
        NewForm(Form1);Set(fieldedit,false)

    Form1 As form:
        DataSource: ='Customer Target Pricing'
        Height: =94
        SnapToColumns: =false
        Width: =1364
        X: =2
        Y: =92
        ZIndex: =3

        "'Customer Lead Id_DataCard1' As typedDataCard.comboBoxEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="ntz_CustomerLeadId"
            Default: =First(Filter(Leads,Lead=GUID([@ModelDrivenFormIntegration].Item.Lead)))
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Customer Target Pricing'],DataSourceInfo.DisplayName,"ntz_CustomerLeadId")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =91
            Required: =true
            Update: =
            Width: =452
            X: =1
            Y: =0
            ZIndex: =1

            DataCardKey4 As label:
                Height: =13
                Size: =12
                Text: |-
                    ="Lead:"
                Width: =Parent.Width - 60
                Wrap: =false
                X: =35
                Y: =32
                ZIndex: =1

            TextInput3 As text:
                Default: |
                    =First(Filter(Leads,Lead=GUID([@ModelDrivenFormIntegration].Item.Lead))).Name
                DisplayMode: =DisplayMode.Disabled
                Height: =21
                Width: =399
                X: =35
                Y: =45
                ZIndex: =5

        Contact_DataCard1 As typedDataCard.comboBoxEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="ntz_Contact"
            Default: =First(Filter(Contacts,Contact=GUID(LeadDataStore.'Parent Contact for lead'.'Full Name')))
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Customer Target Pricing'],DataSourceInfo.DisplayName,"ntz_Contact")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =
            Width: =454
            X: =452
            Y: =0
            ZIndex: =1

            DataCardKey1 As label:
                Height: =14
                Size: =12
                Text: |-
                    ="Contact:"
                Width: =376
                Wrap: =false
                X: =37
                Y: =34
                ZIndex: =1

            TextInput4 As text:
                Default: =First(Filter(Contacts,Contact=LeadDataStore.'Parent Contact for lead'.Contact)).'Full Name'
                DisplayMode: =DisplayMode.Disabled
                Height: =20
                Width: =381
                X: =37
                Y: =48
                ZIndex: =2

        "'Expiry Date_DataCard1' As typedDataCard.dateTimeEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="ntz_expirydate"
            Default: =ThisItem.'Expiry Date'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Customer Target Pricing'],DataSourceInfo.DisplayName,"ntz_expirydate")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =71
            Required: =false
            Update: =DateValue1.SelectedDate
            Width: =339
            X: =791
            Y: =0
            ZIndex: =1

            DataCardKey5 As label:
                Height: =15
                Size: =12
                Text: =Parent.DisplayName
                Width: =300
                Wrap: =false
                X: =19
                Y: =35
                ZIndex: =1

            DateValue1 As datepicker:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                DefaultDate: =Parent.Default
                DisplayMode: =Parent.DisplayMode
                EndYear: =Year(Today())+1
                Height: =20
                InputTextPlaceholder: =If(IsBlank(Self.SelectedDate), Text(Today(), Self.Format, Self.Language))
                IsEditable: =true
                OnSelect: =If (DateValue1.SelectedDate < MyDate,Label7)
                PaddingBottom: =0
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                Size: =10
                StartYear: =Year(Today())
                Tooltip: =Parent.DisplayName
                Width: =311
                X: =28
                Y: =50
                ZIndex: =2

            Separator1 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: |-
                    =":"
                Width: =10
                Wrap: =false
                X: =
                Y: =
                ZIndex: =4

            ErrorMessage4 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =
                ZIndex: =6

            StarVisible4 As label:
                Align: =Align.Center
                Height: =DataCardKey5.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey5.Y
                ZIndex: =7

    Header_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =3

        Logo_1 As image:
            Height: =90
            Image: =Kollaras_and_Co
            PaddingRight: =0.00
            PaddingTop: =0.00
            Width: =290
            X: =12
            Y: =2
            ZIndex: =1

        "'Header Label_1' As label":
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Height: =90
            PaddingRight: =5.00
            PaddingTop: =5.00
            Size: =24
            Text: ="                   Customer Target Pricing"
            Width: =1366
            Y: =2
            ZIndex: =2

    Gallery1 As gallery.variableTemplateHeightGallery:
        Height: =117
        Items: =Products
        Layout: =Layout.Vertical
        TemplatePadding: =6
        TemplateSize: =84
        Width: =1366
        Y: =355
        ZIndex: =4

        TextInput2 As text:
            BorderThickness: =1
            Default: =ThisItem.'Product Description'
            DisplayMode: =If(fieldedit,DisplayMode.Edit,Disabled)
            Height: =20
            OnSelect: =Select(Parent)
            Size: =10
            Width: =339
            X: =16
            Y: =14
            ZIndex: =1

        TextInput5 As text:
            BorderThickness: =1
            Default: =ThisItem.'Product Code'
            DisplayMode: =If(fieldedit,DisplayMode.Edit,Disabled)
            Height: =20
            OnSelect: =Select(Parent)
            Size: =10
            Width: =150
            X: =357
            Y: =14
            ZIndex: =2

        TextInput12 As text:
            BorderThickness: =1
            Default: =ThisItem.'Customer Min Price'
            DisplayMode: =If(fieldedit,DisplayMode.Edit,Disabled)
            Height: =20
            OnSelect: =Select(Parent)
            Size: =10
            Width: =150
            X: =509
            Y: =14
            ZIndex: =8

        TextInput13 As text:
            BorderThickness: =1
            Default: =ThisItem.'Customer Max Price'
            DisplayMode: =If(fieldedit,DisplayMode.Edit,Disabled)
            Height: =20
            OnSelect: =Select(Parent)
            Size: =10
            Width: =150
            X: =661
            Y: =14
            ZIndex: =9

        TextInput14 As text:
            BorderThickness: =1
            Default: =ThisItem.'Customer Currency'
            DisplayMode: =If(fieldedit,DisplayMode.Edit,Disabled)
            Height: =20
            OnSelect: =Select(Parent)
            Size: =10
            Width: =150
            X: =965
            Y: =14
            ZIndex: =10

        TextInput15 As text:
            BorderThickness: =1
            Default: =ThisItem.'Qty Required'
            DisplayMode: =If(fieldedit,DisplayMode.Edit,Disabled)
            Height: =20
            OnSelect: =Select(Parent)
            Size: =10
            Width: =150
            X: =813
            Y: =14
            ZIndex: =11

        Edit_icon As icon.Edit:
            DisplayMode: =
            Height: =22
            Icon: =Icon.Edit
            OnSelect: |
                =Set(fieldedit,true)
            Tooltip: ="Edit "
            Width: =53
            X: =1130
            Y: =12
            ZIndex: =12

        Icon3 As icon.Trash:
            Height: =22
            Icon: =Icon.Trash
            OnSelect: =Remove(Products,ThisItem)
            Tooltip: ="Delete"
            Width: =53
            X: =1199
            Y: =12
            ZIndex: =16

    Container3 As groupContainer.horizontalAutoLayoutContainer:
        Height: =53
        LayoutMode: =LayoutMode.Auto
        Visible: =false
        Width: =1364
        Y: =182
        ZIndex: =5

        ComboBox1 As combobox:
            DisplayFields: =["Description"]
            Height: =50
            IsSearchable: =false
            SearchFields: =["Description"]
            SearchItems: =[]
            SelectMultiple: =false
            Width: =240
            Y: =2
            ZIndex: =1

        Label2 As label:
            Text: =""
            Width: =10
            ZIndex: =2

        TextInput1 As text:
            AlignInContainer: =AlignInContainer.Stretch
            Default: =
            DisplayMode: =DisplayMode.Disabled
            LayoutMinHeight: =20
            Width: =90
            ZIndex: =3

        Label2_1 As label:
            Text: =""
            Width: =10
            ZIndex: =4

        TextInput1_1 As text:
            AlignInContainer: =AlignInContainer.Stretch
            Default: =""
            DisplayMode: =DisplayMode.Disabled
            LayoutMinHeight: =20
            Width: =40
            ZIndex: =5

        Label2_2 As label:
            Text: =""
            Width: =10
            ZIndex: =6

        TextInput1_2 As text:
            AlignInContainer: =AlignInContainer.Stretch
            Default: =""
            DisplayMode: =DisplayMode.Disabled
            LayoutMinHeight: =20
            Width: =70
            ZIndex: =7

        Label2_3 As label:
            Text: =""
            Width: =10
            ZIndex: =8

        TextInput1_3 As text:
            AlignInContainer: =AlignInContainer.Stretch
            Default: =
            DisplayMode: =DisplayMode.Disabled
            LayoutMinHeight: =20
            Width: =90
            ZIndex: =9

        Label2_4 As label:
            Text: =""
            Width: =10
            ZIndex: =10

        Checkbox1 As checkbox:
            AlignInContainer: =AlignInContainer.Stretch
            LayoutMinHeight: =20
            OnCheck: =Set(Decoded,true)
            OnUncheck: =Set(Decoded,false)
            Size: =0
            Text: =Decoded
            Width: =60
            ZIndex: =11

        Label2_5 As label:
            Text: =""
            Width: =10
            ZIndex: =12

        Checkbox1_1 As checkbox:
            AlignInContainer: =AlignInContainer.Stretch
            LayoutMinHeight: =20
            OnCheck: =Set(NonRefill,true)
            OnUncheck: =Set(NonRefill,false)
            Size: =0
            Text: =NonRefill
            Width: =60
            ZIndex: =13

        Label2_6 As label:
            Text: =""
            Width: =10
            ZIndex: =14

        TextInput1_4 As text:
            AlignInContainer: =AlignInContainer.Stretch
            Default: =""
            LayoutMinHeight: =20
            Width: =60
            ZIndex: =15

        Label2_7 As label:
            Text: =""
            Width: =10
            ZIndex: =16

        TextInput1_5 As text:
            AlignInContainer: =AlignInContainer.Stretch
            Default: =""
            LayoutMinHeight: =20
            Width: =60
            ZIndex: =17

        Label2_8 As label:
            Text: =""
            Width: =10
            ZIndex: =18

        TextInput1_6 As text:
            AlignInContainer: =AlignInContainer.Stretch
            Default: =""
            LayoutMinHeight: =15
            Width: =100
            ZIndex: =19

        Label2_9 As label:
            Text: =""
            Width: =10
            ZIndex: =20

        Label2_10 As label:
            Text: =""
            Width: =10
            ZIndex: =21

        TextInput1_7 As text:
            Default: =""
            Width: =90
            ZIndex: =22

        Icon1 As icon.Add:
            AlignInContainer: =AlignInContainer.Stretch
            Height: =40
            Icon: =Icon.Add
            LayoutMinHeight: =20
            OnSelect: |-
                =Collect(Products,{'Product Description':ProductList_CB.Selected.Product_Description,'Product Code':'Product _Code'.Text,'Alc %':ALC_value.Text,'Carton Quantity':Carton_Quantity_vlaue.Text,Varient:Variant_value.Text,'De-Coded':Decoded_CB.Text,'Non-Refill':NonRefiil_CB.Text,'Customer Min Price':MinPrice_value.Text,'Customer Max Price':MaxPrice_value.Text,'Customer Currency':Currency_value.Text,'Qty Required':Quantity_value.Text});
            Width: =45
            ZIndex: =23

    SaveButton As button:
        Height: =26
        OnSelect: |-
            =If(IsBlank(ProductList_CB),Notify("Product is Required",NotificationType.Error),
            
            If(MinPrice_value.Text="",Notify("Min price is Required",NotificationType.Error),If(IsBlank(MaxPrice_value.Text),Notify("Max price is Required",NotificationType.Error),
            If(Value(MinPrice_value.Text)>Value(MaxPrice_value.Text),Notify("Max price can not be less then Min Price",NotificationType.Error),
            
            ForAll(Sequence(CountRows(Products)),Patch('Customer Target Pricing',Defaults('Customer Target Pricing'),{Contact:First(Filter(Contacts,Contact=LeadDataStore.'Parent Contact for lead'.Contact)),'Customer Lead Id':First(Filter(Leads,Lead=GUID([@ModelDrivenFormIntegration].Item.Lead))),'Expiry Date':DateValue1.SelectedDate,Description:Last(FirstN(Products,Value)).'Product Description','Item No':Last(FirstN(Products,Value)).'Product Code','Btl/Ctn':Last(FirstN(Products,Value)).'Carton Quantity',Variant:Last(FirstN(Products,Value)).Varient,'Min Price (ntz_minprice)':Value(Last(FirstN(Products,Value)).'Customer Min Price'),'Max Price (ntz_maxprice)':Value(Last(FirstN(Products,Value)).'Customer Max Price'),Currency:Last(FirstN(Products,Value)).'Customer Currency',Quantity:Value(Last(FirstN(Products,Value)).'Qty Required'),ABV:Value(Last(FirstN(Products,Value)).'Alc %'),Barcode:If( true  in Last(FirstN(Products,Value)).'De-Coded','Barcode (Customer Target Pricing)'.Coded,'Barcode (Customer Target Pricing)'.DeCoded),Bottle:If( true  in Last(FirstN(Products,Value)).'Non-Refill','Bottle (Customer Target Pricing)'.Refill,'Bottle (Customer Target Pricing)'.'Non Refill'),'Lt/Btl':Value(Last(FirstN(Products,Value)).'Lt/Btl')}));Notify("Record submision sucessfull",NotificationType.Success)))));
            
            
            Clear(Products);ResetForm(Form1);NewForm(Form1);Reset(ProductList_CB);Reset('Product _Code');Reset(ALC_value);Reset(Carton_Quantity_vlaue);Reset(Variant_value);Reset(MinPrice_value);Reset(MaxPrice_value);Reset(Currency_value);Reset(Quantity_value);Reset(Decoded_CB);Reset(NonRefiil_CB);Set(Decoded, false );Set(NonRefill, false );
        Text: ="Save"
        Width: =292
        X: =1058
        Y: =540
        ZIndex: =6

    Home_Icon As icon.ArrowLeft:
        Height: =54
        Icon: =Icon.Home
        OnSelect: =Navigate('Home Screen')
        Width: =57
        X: =1278
        Y: =2
        ZIndex: =7

    Label3 As label:
        Color: =RGBA(172, 62, 11, 1)
        Fill: =RGBA(255, 255, 255, 1)
        Height: =47
        Text: ="Max Price can't be less than Min Price"
        Visible: =If(Value(Text(MaxPrice_value))> Value(Text(MinPrice_value))||IsBlank(MaxPrice_value),false,true)
        Width: =166
        X: =449
        Y: =312
        ZIndex: =36

    Label4 As label:
        Color: =RGBA(255, 0, 0, 1)
        FontWeight: =FontWeight.Bold
        Height: =22
        Text: ="*"
        Width: =56
        X: =691
        Y: =205
        ZIndex: =37

    Label8 As label:
        Text: =
        X: =38
        Y: =72
        ZIndex: =38

    Group1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =38

        ProductList_CB As combobox:
            DisplayFields: =["Product_Description"]
            Height: =28
            Items: ='Product Details_V'
            OnChange: |-
                =If(ProductList_CB.Selected.Barcode = "Coded",Set(Decoded,true),Set(Decoded,false));
                If(ProductList_CB.Selected.Bottle = "REF",Set(NonRefill,true),Set(NonRefill,false));
            OnSelect: |-
                =If(ProductList_CB.Selected.Barcode = "Coded",Set(Decoded,true),Set(Decoded,false));
                If(ProductList_CB.Selected.Bottle = "REF",Set(NonRefill,true),Set(NonRefill,false));
            SearchFields: =["Product_Description","Product_Code"]
            SearchItems: =Search('Product Details_V',ProductList_CB.SearchText,"Product_Description","Product_Code")
            SelectMultiple: =false
            Size: =10
            Width: =422
            X: =32
            Y: =231
            ZIndex: =8

        "'Product _Code' As text":
            Default: =ProductList_CB.Selected.Product_Code
            DisplayMode: =DisplayMode.Disabled
            Height: =28
            Size: =10
            Width: =163
            X: =298
            Y: =288
            ZIndex: =9

        ALC_value As text:
            Default: =ProductList_CB.Selected.Product_Alc
            DisplayMode: =DisplayMode.Disabled
            Height: =28
            Size: =10
            Width: =163
            X: =630
            Y: =288
            ZIndex: =10

        Carton_Quantity_vlaue As text:
            Default: =ProductList_CB.Selected.Product_UOM_Qty
            DisplayMode: =DisplayMode.Disabled
            Height: =28
            Size: =10
            Width: =163
            X: =797
            Y: =288
            ZIndex: =11

        Variant_value As text:
            Default: =ProductList_CB.Selected.Product_Variant
            DisplayMode: =DisplayMode.Disabled
            Height: =28
            Size: =10
            Width: =163
            X: =964
            Y: =288
            ZIndex: =12

        Decoded_CB As checkbox:
            Default: =Decoded
            DisplayMode: =DisplayMode.Disabled
            Height: =46
            OnCheck: =Set(Decoded,true)
            OnUncheck: =Set(Decoded,false)
            Size: =0
            Text: =Decoded
            Width: =88
            X: =81
            Y: =280
            ZIndex: =13

        NonRefiil_CB As checkbox:
            Default: =NonRefill
            DisplayMode: =DisplayMode.Disabled
            Height: =46
            OnCheck: =Set(NonRefill,true)
            OnUncheck: =Set(NonRefill,false)
            Size: =0
            Text: =NonRefill
            Width: =63
            X: =181
            Y: =279
            ZIndex: =14

        MinPrice_value As text:
            Default: =""
            Height: =28
            Width: =193
            X: =468
            Y: =231
            ZIndex: =15

        MaxPrice_value As text:
            Default: =
            Height: =28
            OnChange: =
            Width: =201
            X: =666
            Y: =231
            ZIndex: =16

        Currency_value As text:
            Default: |
                =First(Filter(Currencies,'Transaction Currency'= LeadDataStore.Currency.'Transaction Currency')).'Currency Name'
            FontWeight: =FontWeight.Lighter
            Height: =28
            Width: =161
            X: =872
            Y: =231
            ZIndex: =17

        Quantity_value As text:
            Default: =""
            Height: =28
            Width: =161
            X: =1038
            Y: =230
            ZIndex: =18

        Add_Icon As icon.Add:
            Height: =23
            Icon: =Icon.Add
            OnSelect: |-
                =If(DateValue1.SelectedDate>=MyDate,Collect(Products,{'Product Description':ProductList_CB.Selected.Product_Description,'Product Code':'Product _Code'.Text,'Alc %':ALC_value.Text,'Carton Quantity':Carton_Quantity_vlaue.Text,Varient:Variant_value.Text,'De-Coded':Decoded_CB.Text,'Non-Refill':NonRefiil_CB.Text,'Customer Min Price':MinPrice_value.Text,'Customer Max Price':MaxPrice_value.Text,'Customer Currency':Currency_value.Text,'Qty Required':Quantity_value.Text, 'Lt/Btl':Litres_Value.Text});Reset(ProductList_CB);Reset(MinPrice_value);Reset(MaxPrice_value);Reset(Currency_value);Reset(Quantity_value);Reset(Decoded_CB);Reset(NonRefiil_CB);Reset(Litres_Value);Reset('Product _Code');Reset(ALC_value);Reset(Carton_Quantity_vlaue);Reset(Variant_value));
            X: =1156
            Y: =289
            ZIndex: =19

        Prodcut_lbl As label:
            Height: =30
            Size: =10
            Text: ="Product"
            Width: =422
            X: =32
            Y: =205
            ZIndex: =20

        Label4_26 As label:
            Color: =RGBA(255, 0, 0, 1)
            FontWeight: =FontWeight.Bold
            Height: =32
            Text: ="*"
            Width: =35
            X: =89
            Y: =199
            ZIndex: =21

        Productcode_lbl As label:
            Height: =18
            Size: =10
            Text: ="Product Code"
            Width: =182
            X: =292
            Y: =271
            ZIndex: =22

        ALC_lbl As label:
            Height: =18
            Size: =10
            Text: ="Alc %"
            Width: =101
            X: =629
            Y: =268
            ZIndex: =23

        CQ_Label As label:
            Height: =18
            Size: =10
            Text: ="Carton Quantity"
            Width: =243
            X: =795
            Y: =271
            ZIndex: =24

        Varient_label As label:
            Height: =18
            Size: =10
            Text: ="Varient"
            Width: =186
            X: =962
            Y: =271
            ZIndex: =25

        Decoded_Lbl As label:
            Height: =18
            Size: =10
            Text: ="De-Coded"
            Width: =107
            X: =62
            Y: =270
            ZIndex: =26

        "'Non-refill_lbl' As label":
            Height: =18
            Size: =10
            Text: ="Non-Refill"
            Width: =147
            X: =169
            Y: =271
            ZIndex: =27

        MinPrice_lbl As label:
            Height: =24
            Size: =10
            Text: ="Min Price"
            Width: =201
            X: =468
            Y: =211
            ZIndex: =28

        Maxprice_lbl As label:
            Height: =32
            Size: =10
            Text: =" Max Price"
            Width: =200
            X: =659
            Y: =207
            ZIndex: =29

        Currency_lbl As label:
            Height: =14
            Size: =10
            Text: ="Currency"
            Width: =201
            X: =869
            Y: =216
            ZIndex: =30

        Label4_36 As label:
            Color: =RGBA(255, 0, 0, 1)
            FontWeight: =FontWeight.Bold
            Height: =43
            Text: ="*"
            Width: =34
            X: =943
            Y: =206
            ZIndex: =31

        Quantity_lbl As label:
            Height: =15
            Size: =10
            Text: ="Quantity"
            Width: =152
            X: =1033
            Y: =216
            ZIndex: =32

        Label4_38 As label:
            Color: =RGBA(255, 0, 0, 1)
            FontWeight: =FontWeight.Bold
            Height: =32
            PaddingBottom: =3
            PaddingLeft: =4
            PaddingRight: =4
            PaddingTop: =3
            Text: ="*"
            Width: =20
            X: =534
            Y: =196
            ZIndex: =33

        Litres_Value As text:
            Default: =ProductList_CB.Selected.Product_Net_Volume
            DisplayMode: =DisplayMode.Disabled
            Height: =28
            Width: =163
            X: =464
            Y: =288
            ZIndex: =34

        Litres_lbl As label:
            Height: =18
            Size: =10
            Text: ="Lt/Btl"
            X: =465
            Y: =270
            ZIndex: =35

    Form5 As form:
        DataSource: ='Customer Target Pricing Deploy List'
        DefaultMode: =FormMode.New
        Height: =202
        OnSuccess: =ClearCollect(flowExcelData,GetExcelData.Run(Value(Form5.LastSubmit.ID)));ResetForm(Form5)
        Width: =762
        X: =8
        Y: =564
        ZIndex: =39

        Title_DataCard1 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Title"
            Default: =ThisItem.Title
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Customer Target Pricing Deploy List'],DataSourceInfo.DisplayName,"Title")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Customer Target Pricing Deploy List'], DataSourceInfo.MaxLength, "Title")
            Required: =true
            Update: =DataCardValue32.Text
            Visible: =false
            Width: =254
            X: =0
            Y: =0
            ZIndex: =48

            DataCardKey37 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue32 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: ="Customer_Target_Pricing_" & Now()
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey37.Y + DataCardKey37.Height + 5
                ZIndex: =2

            ErrorMessage34 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue32.Y + DataCardValue32.Height
                ZIndex: =3

            StarVisible34 As label:
                Align: =Align.Center
                Height: =DataCardKey37.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey37.Y
                ZIndex: =4

        Attachments_DataCard2 As typedDataCard.attachmentsEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="{Attachments}"
            Default: =ThisItem.Attachments
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Customer Target Pricing Deploy List'],DataSourceInfo.DisplayName,"{Attachments}")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =112
            Required: =false
            Update: =DataCardValue33.Attachments
            Width: =254
            X: =1
            Y: =0
            ZIndex: =48

            DataCardKey38 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue33 As attachments:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                DisplayMode: =Parent.DisplayMode
                Height: =126
                IsInDataCard: =true
                Items: =Parent.Default
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =21
                ZIndex: =2

            ErrorMessage35 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue33.Y + DataCardValue33.Height
                ZIndex: =3

            StarVisible35 As label:
                Align: =Align.Center
                Height: =DataCardKey38.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey38.Y
                ZIndex: =4

    Button4 As button:
        OnSelect: =SubmitForm(Form5);
        Text: ="Upload"
        X: =264
        Y: =631
        ZIndex: =40

    Label7 As label:
        Color: =Red
        Height: =39
        Text: ="Expiry date should be future date"
        Visible: =If(DateValue1.SelectedDate<MyDate,true,false)
        Width: =410
        X: =940
        Y: =160
        ZIndex: =41

    Label10 As label:
        Fill: =RGBA(0, 0, 0, 1)
        Height: =766
        Text: =
        Width: =4
        Y: =2
        ZIndex: =43

    Label12 As label:
        Fill: =RGBA(0, 0, 0, 1)
        Height: =766
        Text: =
        Width: =4
        X: =1362
        ZIndex: =45

    Label13 As label:
        Fill: =RGBA(0, 0, 0, 1)
        Height: =4
        Text: =
        Width: =1366
        ZIndex: =46

    Label14 As label:
        Fill: =RGBA(0, 0, 0, 1)
        Height: =4
        Text: =
        Width: =1366
        Y: =764
        ZIndex: =47

